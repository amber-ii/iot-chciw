select A1.preDate,A1.Date,A2.LI4501_PV,
A2.LI4502_PV,
A2.LI4503_PV,
A2.LI4504_PV,
A2.LI4505_PV,
A2.LI4506_PV,
A2.LI4507_PV,
A2.LI4508_PV,

A1.OPCUA_3LI201_PV,A1.OPCUA_3LI202_PV
,A1.OPCUA_3LI203_PV
,A1.OPCUA_3LI204_PV
from 
(select (A.Date)AS Date,(B.Date)AS preDate ,
(A.OPCUA_3LI201_PV-B.OPCUA_3LI201_PV)AS OPCUA_3LI201_PV ,
(A.OPCUA_3LI202_PV-B.OPCUA_3LI202_PV)AS OPCUA_3LI202_PV,
(A.OPCUA_3LI203_PV-B.OPCUA_3LI203_PV)AS OPCUA_3LI203_PV,
(A.OPCUA_3LI204_PV-B.OPCUA_3LI204_PV)AS OPCUA_3LI204_PV
from 
(SELECT  ROW_NUMBER() OVER (ORDER BY convert(varchar,time, 111)) AS id ,
([OPCUA_A25DCS_25_3_A25_3_3LI201_PV__VALUE]*1.82*1200) as OPCUA_3LI201_PV,
  ([OPCUA_A25DCS_25_3_A25_3_3LI202_PV__VALUE]*1.82*1200) as OPCUA_3LI202_PV,
 ([OPCUA_A25DCS_25_3_A25_3_3LI203_PV__VALUE]*1.82*1200) as OPCUA_3LI203_PV,
  ([OPCUA_A25DCS_25_3_A25_3_3LI204_PV__VALUE]*1.82*1200) as OPCUA_3LI204_PV
  , (convert(varchar,time, 111)) as Date
  FROM [KEP].[dbo].[A2503DCS]  where (convert(varchar,time, 126)) LIKE  '%08:00:%')AS A , 
  (SELECT  ROW_NUMBER() OVER (ORDER BY convert(varchar,time, 111)) AS id ,
([OPCUA_A25DCS_25_3_A25_3_3LI201_PV__VALUE]*1.82*1200) as OPCUA_3LI201_PV,
  ([OPCUA_A25DCS_25_3_A25_3_3LI202_PV__VALUE]*1.82*1200) as OPCUA_3LI202_PV,
  ([OPCUA_A25DCS_25_3_A25_3_3LI203_PV__VALUE]*1.82*1200) as OPCUA_3LI203_PV,
  ([OPCUA_A25DCS_25_3_A25_3_3LI204_PV__VALUE]*1.82*1200) as OPCUA_3LI204_PV
  , (convert(varchar,time, 111)) as Date
  FROM [KEP].[dbo].[A2503DCS]  where (convert(varchar,time, 126)) LIKE  '%08:00:%')AS B
  where B.id = A.id-1 and A.Date between DATEADD (DAY,1,@startDate) and @endDate)as A1 join 




  (select (A.Date)AS Date,(B.Date)AS preDate ,
(A.LI4501_PV*1.82*1200) as LI4501_PV,
  (A.LI4502_PV*1.82*1200) as LI4502_PV,
 (A.LI4503_PV*1.82*1200) as LI4503_PV,
  (A.LI4504_PV*1.82*1200) as LI4504_PV,
  (A.LI4505_PV*1.82*1200) as LI4505_PV,
  (A.LI4506_PV*1.82*1200) as LI4506_PV,
  (A.LI4507_PV*1.82*1200) as LI4507_PV,
  (A.LI4508_PV*1.82*1200) as LI4508_PV
from 
(SELECT  ROW_NUMBER() OVER (ORDER BY convert(varchar,[OPCUA_A25DCS_Device1_LocalDA_Device1_XV4508_3_MV__TIMESTAMP], 111)) AS id ,
([LI4501_PV__VALUE]*1.82*1200) as LI4501_PV,
  ([LI4502_PV__VALUE]*1.82*1200) as LI4502_PV,
 ([LI4503_PV__VALUE]*1.82*1200) as LI4503_PV,
  ([LI4504_PV__VALUE]*1.82*1200) as LI4504_PV,
  ([LI4505_PV__VALUE]*1.82*1200) as LI4505_PV,
  ([LI4506_PV__VALUE]*1.82*1200) as LI4506_PV,
  ([LI4507_PV__VALUE]*1.82*1200) as LI4507_PV,
  ([LI4508_PV__VALUE]*1.82*1200) as LI4508_PV

  , (convert(varchar,[OPCUA_A25DCS_Device1_LocalDA_Device1_XV4508_3_MV__TIMESTAMP], 111)) as Date
  FROM [KEP].[dbo].[A25DCSDB]  where (convert(varchar,[OPCUA_A25DCS_Device1_LocalDA_Device1_XV4508_3_MV__TIMESTAMP], 126)) LIKE  '%08:00:%')AS A , 
  (SELECT  ROW_NUMBER() OVER (ORDER BY convert(varchar,[OPCUA_A25DCS_Device1_LocalDA_Device1_XV4508_3_MV__TIMESTAMP], 111)) AS id ,
([LI4501_PV__VALUE]*1.82*1200) as LI4501_PV,
  ([LI4502_PV__VALUE]*1.82*1200) as LI4502_PV,
 ([LI4503_PV__VALUE]*1.82*1200) as LI4503_PV,
  ([LI4504_PV__VALUE]*1.82*1200) as LI4504_PV,
  ([LI4505_PV__VALUE]*1.82*1200) as LI4505_PV,
  ([LI4506_PV__VALUE]*1.82*1200) as LI4506_PV,
  ([LI4507_PV__VALUE]*1.82*1200) as LI4507_PV,
  ([LI4508_PV__VALUE]*1.82*1200) as LI4508_PV
  , (convert(varchar,[OPCUA_A25DCS_Device1_LocalDA_Device1_XV4508_3_MV__TIMESTAMP], 111)) as Date
  FROM [KEP].[dbo].[A25DCSDB]  where (convert(varchar,[OPCUA_A25DCS_Device1_LocalDA_Device1_XV4508_3_MV__TIMESTAMP], 126)) LIKE  '%08:00:%')AS B
  where B.id = A.id-1 and A.Date between DATEADD (DAY,1,@startDate) and @endDate)as A2
  on A1.Date = A2.Date